#ifndef _GAME_MENU_H
#define _GAME_MENU_H

#include <Arduino.h>
#include <sound.h>
#include <vibrator.h>
#include <inputlistener.h>
#include <U8g2lib.h>

#include <game_spaceinvaders.h>
#include <game_snake.h>
static const unsigned char logo[] U8X8_PROGMEM =
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xff, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x1f, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xff, 0xe1, 0x7f, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0xff, 0xc0, 0xff, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0x3f, 0x00, 0xff, 0x07,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfc, 0x0f, 0x00, 0xfc,
        0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x0f, 0x00,
        0xf0, 0x3f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xff, 0x1f,
        0x00, 0xe0, 0x7f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xff,
        0xff, 0x7f, 0x80, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0,
        0xff, 0xff, 0xff, 0x01, 0xfe, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xf0, 0xf7, 0xff, 0xff, 0x03, 0xfc, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0xf0, 0xc3, 0xff, 0xff, 0x07, 0xf0, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0xf8, 0x00, 0xff, 0xff, 0x0f, 0xc0, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x38, 0x00, 0xff, 0xff, 0x0f, 0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xff, 0xff, 0x0f, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0e, 0x00, 0xfe, 0xff, 0x0f, 0x00, 0x18, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0xfe, 0xff, 0x07, 0x00, 0x38, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0xfc, 0xff, 0x07, 0x00, 0x38,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0xf8, 0xff, 0x01, 0x00,
        0x38, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x0f, 0x00, 0xc0, 0x7f, 0x00,
        0x00, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x0f, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x0f, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x0f, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x78, 0x00, 0x1e, 0x06, 0x07, 0x04, 0x18, 0x1c, 0x00, 0xc0, 0x0f,
        0x00, 0x00, 0x00, 0x00, 0x00, 0xfc, 0x00, 0x3f, 0x87, 0x1f, 0x0c, 0x1c, 0x7e, 0x00, 0xc0,
        0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe, 0x00, 0x03, 0x8f, 0x19, 0x0c, 0x3c, 0x66, 0x00,
        0xc0, 0x0f, 0xfc, 0x00, 0x00, 0xc0, 0x8f, 0xff, 0x00, 0x03, 0x8d, 0x19, 0x0c, 0x34, 0x66,
        0x00, 0xc0, 0x0f, 0xfe, 0x03, 0x00, 0xe0, 0xff, 0xff, 0x00, 0x9f, 0x8d, 0x0f, 0x0c, 0x26,
        0x3e, 0x00, 0xc0, 0x0f, 0xfe, 0x07, 0x00, 0xf0, 0xff, 0xff, 0x00, 0x9f, 0x9d, 0x19, 0x0c,
        0x76, 0x66, 0x00, 0xc0, 0x0f, 0xff, 0x0f, 0x00, 0xf8, 0xff, 0xff, 0x00, 0x83, 0x9f, 0x19,
        0x0c, 0x7e, 0xc6, 0x00, 0xc0, 0x0f, 0xff, 0x1f, 0x00, 0xfc, 0xff, 0xff, 0x00, 0xc3, 0x98,
        0x19, 0x0c, 0x63, 0x66, 0x00, 0xc0, 0x0f, 0xff, 0x1f, 0x00, 0xfe, 0xff, 0xff, 0x00, 0xc3,
        0x98, 0x1f, 0x7c, 0xc3, 0x7e, 0x00, 0xc0, 0x0f, 0xff, 0x3f, 0x00, 0xfe, 0xff, 0xff, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x0f, 0xff, 0x3f, 0x00, 0xff, 0xff, 0x79,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x0f, 0xff, 0x7f, 0x00, 0xff, 0x7f,
        0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x0f, 0xff, 0x7f, 0x00, 0xff,
        0x3f, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x0f, 0xfe, 0x7f, 0x00,
        0xff, 0x1f, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0xfe, 0x7f,
        0x80, 0xff, 0x1f, 0x38, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0xfc,
        0x7f, 0x80, 0xff, 0x1f, 0x38, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f,
        0xfc, 0x7f, 0x80, 0xff, 0x0f, 0x38, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x0e, 0xf8, 0x7f, 0x00, 0xff, 0x07, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x0e, 0xf8, 0x7f, 0x00, 0xff, 0x03, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x1c, 0xf8, 0x3f, 0x00, 0xff, 0x01, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x3c, 0xf8, 0x1f, 0x00, 0xfe, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xf8, 0xf8, 0x0f, 0x00, 0x00, 0xc0, 0x07, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xfb, 0x0f, 0x00, 0x00, 0xe0, 0x03, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xff, 0x0f, 0x00, 0x00, 0xf8, 0x03, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0xff, 0x0f, 0x00, 0x00, 0xfe, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xff, 0x0f, 0x00, 0x80, 0xff, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xff, 0x0f, 0x00, 0xc0, 0x7f,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x0f, 0x00, 0xf0,
        0x3f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe, 0x0f, 0x00,
        0xfc, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0x3f,
        0x00, 0xfe, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf0,
        0x7f, 0x80, 0xff, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0xff, 0xe1, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0xff, 0xf3, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0xf0, 0xf3, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00};
// #define DEBUG_GAME

#ifdef DEBUG_GAME
#define DEBUG_GAME_PRINT(x) Serial.print(x)
#define DEBUG_GAME_PRINTLN(x) Serial.println(x)
#else
#define DEBUG_GAME_PRINT(x)
#define DEBUG_GAME_PRINTLN(x)
#endif

enum class GameMenuState
  {
    GAME_INIT,
    GAME_MENU,
    GAME_NORMAL
  };

class GameMenu : public Game
{
public:
  GameMenu(U8G2 *display, Sound *sound, Vibrator *vibrator);

  void init();
  void loop(unsigned long nowMs, unsigned long dtMs);

  void repeatPressEvent(Button button, unsigned long nowMs);

  void pressEvent(Button button, unsigned long nowMs);

private:
  U8G2 *display;
  Sound *sound;
  Vibrator *vibrator;

  Game *game;

  int displayWidth;
  int displayHeight;
  int currentMenu = 0;

  enum GameMenuState gameState = GameMenuState::GAME_INIT;

  void displayRestart();
  void drawMenu();
};
#endif
